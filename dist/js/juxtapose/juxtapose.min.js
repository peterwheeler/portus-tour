!function(t,e){function i(t,e){this.image=new Image,this.loaded=!1,this.image.src=t.src,this.label=t.label||!1,this.credit=t.credit||!1,this.id=t.id||!1}function r(t,e){var i=this;this.image=new Image,this.loaded=!1,this.flickrID=this.getFlickrID(t.src),this.callFlickrAPI(this.flickrID,i),this.label=t.label||!1,this.credit=t.credit||!1,this.id=t.id||!1}function s(t){if(t.naturalWidth&&t.naturalHeight)return{width:t.naturalWidth,height:t.naturalHeight};var e=new Image;return e.src=t.src,{width:e.width,height:e.height}}function n(t){return{width:s(t).width,height:s(t).height,aspect:function(){return this.width/this.height}}}function a(e,i){var r=t.getElementById(i),s=r?r.parentNode:{};return s.id&&s.id===e?r:{}}function o(t,e){return t.className&&new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.className)}function l(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function d(t,e){t.className=t.className.replace(/(\S+)\s*/g,function(t,i){return i===e?"":t}).replace(/^\s+/,"")}function p(e,i){t.body.textContent?e.textContent=i:e.innerText=i}function c(t){return e.getComputedStyle?{width:parseInt(getComputedStyle(t).width,10),height:parseInt(getComputedStyle(t).height,10)}:(w=t.getBoundingClientRect().right-t.getBoundingClientRect().left,h=t.getBoundingClientRect().bottom-t.getBoundingClientRect().top,{width:parseInt(w,10)||0,height:parseInt(h,10)||0})}function g(e){return e.pageX?e.pageX:e.touches?e.touches[0].pageX:e.clientX+t.body.scrollLeft+t.documentElement.scrollLeft}function u(e){return e.pageY?e.pageY:e.touches?e.touches[0].pageY:e.clientY+t.body.scrollTop+t.documentElement.scrollTop}function m(t){return-1!=t.indexOf("flickr.com/photos/")}function f(e,i){if("string"==typeof i||"number"==typeof i)leftPercent=parseInt(i,10);else{var r=e.getBoundingClientRect(),s={top:r.top+t.body.scrollTop,left:r.left+t.body.scrollLeft},n=e.offsetWidth,a=g(i),o=a-s.left;leftPercent=o/n*100}return leftPercent}function b(e,i){if("string"==typeof i||"number"==typeof i)topPercent=parseInt(i,10);else{var r=e.getBoundingClientRect(),s={top:r.top+t.body.scrollTop,left:r.left+t.body.scrollLeft},n=e.offsetHeight,a=u(i),o=a-s.top;topPercent=o/n*100}return topPercent}function v(t){return"string"!=typeof t?Boolean(t):!("false"===t||""===t)}function D(t,e,s){this.selector=t,this.images=[],this.imageDivs=[];var n;this.options={animate:!0,showLabels:!0,showCredits:!0,makeResponsive:!0,startingPosition:"50%",mode:"horizontal",multiSelect:!0,callback:null};for(n in this.options)n in s&&(this.options[n]=n in C?v(s[n]):s[n]);if(e.length>=2)for(var n=0;n<e.length;n++)m(e[n].src)?this.imgNew=new r(e[n],this):this.imgNew=new i(e[n],this),this.imgNew.loaded=!0,!0===this.imgNew.loaded&&this._onLoaded(this.imgNew),this.images.push(this.imgNew);else e.length<2&&console.warn("The images parameter takes at least two Image objects.");this.imgBefore=this.images[0],this.imgAfter=this.images[1],this.allLoaded=function(t){return!0},!0===this.images.every(this.allLoaded)&&this._allLoaded()}var A={sliders:[],OPTIMIZATION_ACCEPTED:1,OPTIMIZATION_WAS_CONSTRAINED:2},y=["Large","Medium"];r.prototype={getFlickrID:function(t){var e=t.indexOf("flickr.com/photos/"),i=e+"flickr.com/photos/".length,r=t.substr(i);return-1==r.indexOf("/")?null:(0===r.indexOf("/")&&(r=r.substr(1)),id=r.split("/")[1],id)},callFlickrAPI:function(t,e){var i="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key=d90fc2d1f4acc584e08b8eaea5bf4d6c&photo_id="+t+"&format=json&nojsoncallback=1",r=new XMLHttpRequest;r.open("GET",i,!0),r.onload=function(){if(r.status>=200&&r.status<400){data=JSON.parse(r.responseText);var t=e.bestFlickrUrl(data.sizes.size);e.setFlickrImage(t)}else console.error("There was an error getting the picture from Flickr")},r.onerror=function(){console.error("There was an error getting the picture from Flickr")},r.send()},setFlickrImage:function(t){this.image.src=t},bestFlickrUrl:function(t){for(var e={},i=0;i<t.length;i++)e[t[i].label]=t[i].source;for(var r=0;r<y.length;r++)if(y[r]in e)return e[y[r]];return t[0].source}};var C={animate:!0,showLabels:!0,showCredits:!0,makeResponsive:!0};D.prototype={addSlider:function(t,e){"vertical"===this.options.mode?leftPercent=b(this.slider,t):leftPercent=f(this.slider,t),leftPercent=leftPercent.toFixed(2)+"%","vertical"===this.options.mode?e.style.height=leftPercent:e.style.width=leftPercent},updateSlider:function(t,e){var i,r;i="vertical"===this.options.mode?b(this.slider,t):f(this.slider,t),i=i.toFixed(2)+"%",leftPercentNum=parseFloat(i),r=100-leftPercentNum+"%",leftPercentNum>0&&leftPercentNum<100&&(d(this.handle,"transition"),d(this.rightImage,"transition"),d(this.leftImage,"transition"),this.options.animate&&e&&(l(this.handle,"transition"),l(this.leftImage,"transition"),l(this.rightImage,"transition")),"vertical"===this.options.mode?(this.handle.style.top=i,this.leftImage.style.height=i,this.rightImage.style.height=r):(this.handle.style.left=i,this.leftImage.style.width=i,this.rightImage.style.width=r),this.sliderPosition=i)},updateImage:function(e,i){var r,s;r=t.getElementById(e),s=this.slider.getElementsByClassName("jx-image "+i)[0],d(s,i),l(r,i),d(r,"jx-hidden"),l(s,"jx-hidden"),"vertical"===this.options.mode?(r.style.height=s.style.height,s.style.height="50%"):(r.style.width=s.style.width,s.style.width="50%"),"jx-left"===i?this.leftImage=r:this.rightImage=r},getPosition:function(){return this.sliderPosition},displayLabel:function(e,i,r){label=t.createElement("div"),label.className="jx-label jx-label-"+i,label.setAttribute("tabindex",0),p(label,r),e.appendChild(label)},updateLabel:function(e,i){p(t.getElementsByClassName(i)[0],e)},updateDropdown:function(t,e,i){for(var r=0;r<t.length;r++)o(t[r],"enabled")&&d(t[r],"enabled"),t[r].id===i.id&&l(t[r],"enabled");for(var r=0;r<e.length;r++)o(e[r],"disabled")&&d(e[r],"disabled"),t[r].id===i.id&&l(e[r],"disabled")},displayCredits:function(e){credit=t.createElement("div"),credit.className="jx-credit",text="<em>Photo Credits:</em>",e&&(text+=" <em>Before</em> "+e),credit.innerHTML=text},setStartingPosition:function(t){this.options.startingPosition=t},checkImages:function(){return n(this.imgBefore.image).aspect()==n(this.imgAfter.image).aspect()},calculateDims:function(t,e){var i=n(this.imgBefore.image).aspect();return t?e=t/i:e&&(t=e*i),{width:t,height:e,ratio:i}},responsivizeIframe:function(t){return t.height<e.innerHeight?t.ratio>=1&&(this.wrapper.style.paddingTop=parseInt((e.innerHeight-t.height)/2)+"px"):t.height>e.innerHeight&&(t=this.calculateDims(0,e.innerHeight),this.wrapper.style.paddingLeft=parseInt((e.innerWidth-t.width)/2)+"px"),this.options.showCredits&&(t.height-=13),t},setWrapperDimensions:function(){var t=c(this.wrapper).width,i=c(this.wrapper).height,r=this.calculateDims(t,i);e.location===e.parent.location||this.options.makeResponsive||(r=this.responsivizeIframe(r)),console.log(r,e.innerWidth),this.wrapper.style.height=parseInt(r.height)+"px",this.wrapper.style.width=parseInt(r.width)+"px"},optimizeWrapper:function(t){var e=A.OPTIMIZATION_ACCEPTED;return this.imgBefore.image.naturalWidth>=t&&this.imgAfter.image.naturalWidth>=t?(this.wrapper.style.width=t+"px",e=A.OPTIMIZATION_WAS_CONSTRAINED):this.imgAfter.image.naturalWidth<t?this.wrapper.style.width=this.imgAfter.image.naturalWidth+"px":this.wrapper.style.width=this.imgBefore.image.naturalWidth+"px",this.setWrapperDimensions(),e},_onLoaded:function(e){this.currentImage=t.createElement("div"),this.currentImage.className="jx-image jx-hidden",this.currentImage.id=e.id,this.currentImage.setAttribute("data-label",e.label),this.currentImage.appendChild(e.image),!0===this.options.showCredits&&this.displayCredits(e.credit),this.imageDivs.push(this.currentImage)},_allLoaded:function(){this.container=t.getElementsByClassName("juxtapose-container")[0],this.wrapper=t.querySelector(this.selector),l(this.wrapper,"juxtapose"),this.wrapper.style.width=s(this.imgBefore.image).width,this.setWrapperDimensions(),this.slider=t.createElement("div"),this.slider.className="jx-slider",this.wrapper.appendChild(this.slider),"horizontal"!=this.options.mode&&l(this.slider,this.options.mode),this.handle=t.createElement("div"),this.handle.className="jx-handle",this.leftImage=this.imageDivs[0],this.leftImage.className="jx-image jx-left",this.rightImage=this.imageDivs[1],this.rightImage.className="jx-image jx-right",this.leftDropDownContainer=t.createElement("div"),this.leftDropDownContainer.className="dropdown-container dropdown-left",this.leftDropDownButton=t.createElement("a"),this.leftDropDownButton.className="dropdown-button btn left-button",this.leftDropDownButton.setAttribute("data-activates","left-dropdown"),this.leftDropDownButton.setAttribute("data-beloworigin","true"),this.leftDropDownButton.setAttribute("href","#"),this.leftDropDownButton.innerHTML='<i class="material-icons right">&#xE5C5;</i>Left map',this.leftDropDown=t.createElement("ul"),this.leftDropDown.id="left-dropdown",this.leftDropDown.className="dropdown-content",this.rightDropDownContainer=t.createElement("div"),this.rightDropDownContainer.className="dropdown-container dropdown-right",this.rightDropDownButton=t.createElement("a"),this.rightDropDownButton.className="dropdown-button btn right-button",this.rightDropDownButton.setAttribute("data-activates","right-dropdown"),this.rightDropDownButton.setAttribute("data-beloworigin","true"),this.rightDropDownButton.setAttribute("href","#"),this.rightDropDownButton.innerHTML='<i class="material-icons left">&#xE5C5;</i>Right map',this.rightDropDown=t.createElement("ul"),this.rightDropDown.id="right-dropdown",this.rightDropDown.className="dropdown-content",this.leftDropDownContainer.appendChild(this.leftDropDownButton),this.leftDropDownContainer.appendChild(this.leftDropDown),this.rightDropDownContainer.appendChild(this.rightDropDownButton),this.rightDropDownContainer.appendChild(this.rightDropDown);for(var e=0;e<this.imageDivs.length;e++){this.imageDivs[e];this.leftLink=t.createElement("li"),l(this.leftLink,"left-map-link"),this.leftLink.id=this.imageDivs[e].id+"-left",this.leftLink.setAttribute("data-ref",this.imageDivs[e].id),this.leftLink.setAttribute("data-label",this.imageDivs[e].getAttribute("data-label")),this.leftLink.innerHTML='<a href="#">'+this.imageDivs[e].getAttribute("data-label")+"</a>",this.rightLink=t.createElement("li"),l(this.rightLink,"right-map-link"),this.rightLink.id=this.imageDivs[e].id+"-right",this.rightLink.setAttribute("data-ref",this.imageDivs[e].id),this.rightLink.setAttribute("data-label",this.imageDivs[e].getAttribute("data-label")),this.rightLink.innerHTML='<a href="#">'+this.imageDivs[e].getAttribute("data-label")+"</a>",this.leftDropDown.appendChild(this.leftLink),this.rightDropDown.appendChild(this.rightLink)}this.labCredit=t.createElement("a"),this.labCredit.setAttribute("href","http://juxtapose.knightlab.com"),this.labCredit.setAttribute("target","_blank"),this.labCredit.className="jx-knightlab",this.labLogo=t.createElement("div"),this.labLogo.className="knightlab-logo",this.labCredit.appendChild(this.labLogo),this.projectName=t.createElement("span"),this.projectName.className="juxtapose-name",p(this.projectName,"JuxtaposeJS"),this.labCredit.appendChild(this.projectName),this.slider.appendChild(this.handle);for(var e=0;e<this.imageDivs.length;e++)this.slider.appendChild(this.imageDivs[e]);this.slider.appendChild(this.labCredit),this.leftArrow=t.createElement("div"),this.rightArrow=t.createElement("div"),this.control=t.createElement("div"),this.controller=t.createElement("div"),this.leftArrow.className="jx-arrow jx-left",this.rightArrow.className="jx-arrow jx-right",this.control.className="jx-control",this.controller.className="jx-controller",this.controller.setAttribute("tabindex",0),this.controller.setAttribute("role","slider"),this.controller.setAttribute("aria-valuenow",50),this.controller.setAttribute("aria-valuemin",0),this.controller.setAttribute("aria-valuemax",100),this.handle.appendChild(this.leftArrow),this.handle.appendChild(this.control),this.handle.appendChild(this.rightArrow),this.control.appendChild(this.controller),this.container.prepend(this.rightDropDownContainer),this.container.prepend(this.leftDropDownContainer),this._init(),console.log("all loaded")},_init:function(){for(var i=0;i<this.imageDivs.length;i++)this.addSlider(this.options.startingPosition,this.imageDivs[i]);this.updateSlider(this.options.startingPosition,!1),!0===this.options.showLabels&&(this.imgBefore.label&&this.displayLabel(this.wrapper,"left",this.imgBefore.label),this.imgAfter.label&&this.displayLabel(this.wrapper,"right",this.imgAfter.label)),!0===this.options.showCredits&&this.displayCredits();var r=this;e.addEventListener("resize",function(){r.setWrapperDimensions()});var s=t.getElementById("left-dropdown").getElementsByTagName("li"),n=t.getElementById("right-dropdown").getElementsByTagName("li");r.updateDropdown(s,n,a("left-dropdown",this.imgBefore.id+"-left")),r.updateDropdown(n,s,a("right-dropdown",this.imgAfter.id+"-right"));for(var i=0;i<s.length;i++)s[i].addEventListener("click",function(t){t.preventDefault(),r.updateImage(this.getAttribute("data-ref"),"jx-left"),r.updateLabel(this.getAttribute("data-label"),"jx-label-left"),r.updateDropdown(s,n,this)},!1);for(var i=0;i<n.length;i++)n[i].addEventListener("click",function(t){t.preventDefault(),r.updateImage(this.getAttribute("data-ref"),"jx-right"),r.updateLabel(this.getAttribute("data-label"),"jx-label-right"),r.updateDropdown(n,s,this)},!1);this.slider.addEventListener("mousedown",function(t){t=t||e.event,t.preventDefault(),r.updateSlider(t,!0),animate=!0,this.addEventListener("mousemove",function(t){t=t||e.event,t.preventDefault(),animate&&r.updateSlider(t,!1)}),this.addEventListener("mouseup",function(t){t=t||e.event,t.preventDefault(),t.stopPropagation(),this.removeEventListener("mouseup",arguments.callee),animate=!1})}),this.slider.addEventListener("touchstart",function(t){t=t||e.event,t.preventDefault(),t.stopPropagation(),r.updateSlider(t,!0),this.addEventListener("touchmove",function(t){t=t||e.event,t.preventDefault(),t.stopPropagation(),r.updateSlider(event,!1)})}),this.handle.addEventListener("keydown",function(t){t=t||e.event;var i=t.which||t.keyCode,s=parseFloat(this.style.left);if(37==i){s-=1;var n=parseFloat(this.style.left)-1;r.updateSlider(n,!1),r.controller.setAttribute("aria-valuenow",s)}if(39==i){s+=1;var a=parseFloat(this.style.left)+1;r.updateSlider(a,!1),r.controller.setAttribute("aria-valuenow",s)}}),this.leftImage.addEventListener("keydown",function(t){var e=t.which||t.keyCode;13!=e&&32!=e||(r.updateSlider("90%",!0),r.controller.setAttribute("aria-valuenow",90))}),this.rightImage.addEventListener("keydown",function(t){var e=t.which||t.keyCode;13!=e&&32!=e||(r.updateSlider("10%",!0),r.controller.setAttribute("aria-valuenow",10))}),A.sliders.push(this),this.options.callback&&"function"==typeof this.options.callback&&this.options.callback(this)}},A.makeSlider=function(t,e){void 0===e&&(e=A.sliders.length);var i=t,r=i.querySelectorAll("img"),s=[],n={};i.getAttribute("data-animate")&&(n.animate=i.getAttribute("data-animate")),i.getAttribute("data-showlabels")&&(n.showLabels=i.getAttribute("data-showlabels")),i.getAttribute("data-showcredits")&&(n.showCredits=i.getAttribute("data-showcredits")),i.getAttribute("data-startingposition")&&(n.startingPosition=i.getAttribute("data-startingposition")),i.getAttribute("data-mode")&&(n.mode=i.getAttribute("data-mode")),i.getAttribute("data-makeresponsive")&&(n.mode=i.getAttribute("data-makeresponsive")),specificClass="juxtapose-"+e,l(t,specificClass),selector="."+specificClass,i.innerHTML?i.innerHTML="":i.innerText="";for(var a=0;a<r.length;a++)s.push({src:r[a].src,label:r[a].getAttribute("data-label"),credit:r[a].getAttribute("data-credit"),id:r[a].getAttribute("id")});slider=new A.JXSlider(selector,s,n)},A.scanPage=function(){for(var e=t.querySelectorAll(".juxtapose"),i=0;i<e.length;i++)A.makeSlider(e[i],i)},A.JXSlider=D,e.juxtapose=A,A.scanPage()}(document,window),function(t,e){function i(t){var i=e[t];e[t]=function(t){return s(i(t))}}function r(e,i,r){return(r=this).attachEvent("on"+e,function(e){var e=e||t.event;e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0},i.call(r,e)})}function s(t,e){if(e=t.length)for(;e--;)t[e].addEventListener=r;else t.addEventListener=r;return t}t.addEventListener||(s([e,t]),"Element"in t?t.Element.prototype.addEventListener=r:(e.attachEvent("onreadystatechange",function(){s(e.all)}),i("getElementsByTagName"),i("getElementById"),i("createElement"),s(e.all)))}(window,document);